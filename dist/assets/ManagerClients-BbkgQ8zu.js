import{b as S,s as L,r,a4 as A,i as M,j as e,ao as k}from"./index-DOgJOjDG.js";import{r as E}from"./fileHelpers-CKxwqeqX.js";const D=()=>{S(L);const[o,v]=r.useState([]),[i,c]=r.useState(!0),[x,m]=r.useState(null),[s,u]=r.useState(null),[l,f]=r.useState(""),[n,N]=r.useState("all"),d=r.useCallback(async()=>{c(!0);try{const a=await A("/api/manager/clients"),t=Array.isArray(a==null?void 0:a.data)?a.data:a;v(Array.isArray(t)?t:[]),m(null)}catch(a){const t=(a==null?void 0:a.message)||"Failed to load assigned clients";m(t),M.error(t)}finally{c(!1)}},[]);r.useEffect(()=>{d()},[d]);const g=r.useMemo(()=>(!i&&o.length>0?o:[]).filter(t=>{var h,p,b,y,j;const w=!l||((h=t.name)==null?void 0:h.toLowerCase().includes(l.toLowerCase()))||((p=t.company)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))||((b=t.email)==null?void 0:b.toLowerCase().includes(l.toLowerCase())),C=n==="all"||n==="active"&&((y=t.status)==null?void 0:y.toLowerCase())!=="inactive"||n==="inactive"&&((j=t.status)==null?void 0:j.toLowerCase())==="inactive";return w&&C}),[o,i,l,n]);return r.useMemo(()=>((s==null?void 0:s.documents)??[]).map(a=>({...a,url:E(a.file_url)})),[s]),e.jsxs("div",{className:"w-full p-4 space-y-4",children:[e.jsx(k,{title:"Assigned Clients",subtitle:"You can only see clients assigned to you.",onRefresh:d,refreshing:i,children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search clients by name, company, email...",value:l,onChange:a=>f(a.target.value),className:"border rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("select",{value:n,onChange:a=>N(a.target.value),className:"border rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),s?e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 shadow",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-600",children:"Client Detail"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.company||"—"})]}),e.jsx("button",{onClick:()=>u(null),className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:"← Back to list"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[{label:"Client Ref",value:s.ref||"—"},{label:"Manager",value:s.manager_name||"—"},{label:"Status",value:s.status||"Active"},{label:"Created",value:s.created_at?new Date(s.created_at).toLocaleString():"N/A"},{label:"Email",value:s.email||"—"},{label:"Phone",value:s.phone||"—"}].map(a=>e.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-500",children:a.label}),e.jsx("p",{className:"mt-1 text-base font-medium text-gray-900",children:a.value})]},a.label))})]}):i?e.jsx("div",{className:"rounded-lg bg-white p-6 text-center text-gray-500 border border-dashed border-gray-200",children:"Fetching assigned clients..."}):g.length===0?e.jsx("div",{className:"rounded-lg bg-white p-6 text-center text-gray-500 border border-dashed border-gray-200",children:x||"No assigned clients found."}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:[e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Company"}),e.jsx("th",{className:"px-4 py-2",children:"Status"}),e.jsx("th",{className:"px-4 py-2",children:"Email"}),e.jsx("th",{className:"px-4 py-2",children:"Phone"})]})}),e.jsx("tbody",{children:g.map(a=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>u(a),children:[e.jsx("td",{className:"px-4 py-2 text-gray-900",children:a.name}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:a.company||"-"}),e.jsx("td",{className:"px-4 py-2 text-xs",children:e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 font-medium ${a.status==="Inactive"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:a.status||(a.isDeleted?"Inactive":"Active")})}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:a.email||"-"}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:a.phone||"-"})]},a.id||a.public_id||a._id))})]})})]})};export{D as default};

import{u as ve,b as T,s as Ie,r as c,ap as J,j as e,cG as Te,af as we,cP as Ce,be as Le,aC as I,ay as G,a1 as me,b4 as xe,a7 as W,bc as Me,cQ as ge,ci as Oe,aa as _e,cj as Fe,cR as pe,e as A,as as Ve,W as $e,cS as We,cT as U,Y as Ge,cU as ue,ao as he,az as ee,cV as Be,cW as Ke,cX as je,f as be,cY as Ne,cZ as ze,aG as Je,c_ as Ue,c$ as se,d0 as Qe,bR as fe,d1 as He,bS as Ye}from"./index-CV0oviIo.js";import"./sortable.esm-BD2HXmNC.js";import{M as Xe}from"./ManagerApprovalPanel-BwBfA_Yn.js";const Q=a=>{if(a.project_status_info){if(a.project_status_info.is_pending_closure===!0)return!1;if(a.project_status_info.is_closed===!0)return!0}return a.project_status==="CLOSED"},te=a=>a.project_status_info?a.project_status_info.is_pending_closure===!0:a.project_status==="PENDING_FINAL_APPROVAL",Pe=(a,r)=>!!(r.has(a.id)||a.status==="APPROVED"),Se=(a,r)=>Q(a)?"CLOSED":Pe(a,r)?"APPROVED":a.status||"PENDING",Ze=(a,r)=>{switch(Se(a,r)){case"CLOSED":return"bg-blue-100 text-blue-800";case"APPROVED":return"bg-green-100 text-green-800";case"REJECTED":return"bg-red-100 text-red-800";default:return"bg-orange-100 text-orange-800"}},qe=()=>{var R;const a=ve(),r=T(Ie),{readyToApprove:b,alreadyApproved:j,loading:l,error:p}=T(o=>o.workflow),[u,w]=c.useState(null),[i,v]=c.useState(!1),[N,C]=c.useState(null),[f,_]=c.useState(""),[F,H]=c.useState(new Set),[Y,L]=c.useState(new Set),M=((R=r==null?void 0:r.role)==null?void 0:R.toLowerCase())==="admin";c.useEffect(()=>{M&&(a(J("ADMIN")),H(new Set),L(new Set))},[a,M]);const h=async o=>{w(o);try{const x=await a(pe({requestId:o,action:"APPROVE"})).unwrap();if(x&&x.success)A.success(x.message||"Project closure approved successfully"),a(J("ADMIN"));else throw new Error((x==null?void 0:x.message)||"Failed to approve project closure")}catch(x){A.error((x==null?void 0:x.message)||x||"Failed to approve project closure")}finally{w(null)}},B=async()=>{if(!f.trim()){A.error("Please provide a reason for rejection");return}w(N.id);try{await a(pe({requestId:N.id,action:"REJECT",reason:f.trim()})).unwrap(),A.success("Project closure rejected"),a(J("ADMIN")),v(!1),C(null),_("")}catch(o){A.error(o||"Failed to reject project closure")}finally{w(null)}},K=o=>{Q(o)||!te(o)||(C(o),_(""),v(!0))},E=()=>{a(J("ADMIN")),H(new Set),L(new Set)};return M?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Project Closure Approvals"}),e.jsx("button",{onClick:E,disabled:l,className:"p-2 text-gray-400 hover:text-gray-600 disabled:opacity-50",children:e.jsx(Te,{className:`w-5 h-5 ${l?"animate-spin":""}`})})]})}),e.jsxs("div",{className:"p-6",children:[p&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-600",children:p})}),l&&b.length===0&&j.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(we,{className:"w-8 h-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading approvals..."})]}):b.length===0&&j.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"w-8 h-8 mx-auto text-green-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No pending project closures"})]}):e.jsxs("div",{className:"space-y-6",children:[b.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5 text-orange-600"}),"Pending Approvals (",b.length,")"]}),e.jsx("div",{className:"space-y-6",children:b.map(o=>e.jsx(ye,{request:o,isReadyToApprove:!0,processingId:u,onApprove:h,onReject:K,approvedRequests:F},o.id))})]}),j.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-green-600"}),"Already Approved (",j.length,")"]}),e.jsx("div",{className:"space-y-6",children:j.map(o=>e.jsx(ye,{request:o,isReadyToApprove:!1,processingId:u,onApprove:h,onReject:K,approvedRequests:F},o.id))})]})]})]}),i&&N&&!Q(N)&&te(N)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reject Project Closure"}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Rejection *"}),e.jsx("textarea",{value:f,onChange:o=>_(o.target.value),placeholder:"Please provide a reason for rejecting this closure request...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:!f.trim()||u===N.id,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg font-medium transition-colors disabled:cursor-not-allowed",children:u===N.id?"Rejecting...":"Reject Request"})]})]})]})})]}):null},ye=({request:a,isReadyToApprove:r,processingId:b,onApprove:j,onReject:l,approvedRequests:p})=>{const u=Q(a);te(a),Pe(a,p);const w=Se(a,p);return e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[e.jsx("div",{className:`p-6 border-b ${u?"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200":"bg-gradient-to-r from-orange-50 to-orange-100 border-orange-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u?e.jsx(I,{className:"w-6 h-6 text-blue-600"}):e.jsx(me,{className:"w-6 h-6 text-orange-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:u?"Project Closed":r?"Project Closure Request":"Approved Request"}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${Ze(a,p)}`,children:w})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Project"})]}),e.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:a.project_name||`Project ${a.entity_id}`}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",a.project_public_id||a.entity_id]})]}),e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Client"})]}),e.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:a.client_name||"N/A"}),e.jsx("p",{className:"text-xs text-gray-500",children:a.client_email||""})]}),e.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Me,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Productivity"})]}),e.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:a.productivity_score||"N/A"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Total Hours: ",a.total_project_hours||"0"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsxs("span",{children:["Requested by: ",e.jsx("span",{className:"font-medium",children:a.requested_by_name||a.requestedByName||a.requested_by})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsxs("span",{children:["Requested: ",new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]}),e.jsx("div",{className:"flex gap-3 ml-6",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>j(a.id),disabled:b===a.id,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors bg-green-600 hover:bg-green-700 disabled:bg-green-400",title:"Approve project closure",children:[b===a.id?e.jsx(we,{className:"w-4 h-4 animate-spin"}):e.jsx(Ce,{className:"w-4 h-4"}),"Approve Closure"]}),e.jsxs("button",{onClick:()=>l(a),disabled:b===a.id,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors bg-red-600 hover:bg-red-700 disabled:bg-red-400",title:"Reject project closure",children:[e.jsx(G,{className:"w-4 h-4"}),"Reject"]})]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 text-sm font-medium rounded-full",children:[e.jsx(I,{className:"w-4 h-4"}),"Already Approved"]})})]})}),a.reason&&e.jsxs("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Closure Reason"}),e.jsx("p",{className:"text-sm text-gray-600 bg-white p-3 rounded-lg border",children:a.reason})]}),u&&e.jsxs("div",{className:"p-6 bg-blue-50 border-b border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(I,{className:"w-6 h-6 text-blue-600"}),e.jsx("h4",{className:"text-lg font-semibold text-blue-900",children:"Project Already Closed"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/60 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Project Status"})]}),e.jsx("p",{className:"text-sm text-blue-800 font-semibold",children:"Closed"}),e.jsx("p",{className:"text-xs text-gray-600",children:"This project has already been closed"})]}),e.jsxs("div",{className:"bg-white/60 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(me,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Access Status"})]}),e.jsx("p",{className:"text-sm text-gray-800 font-semibold",children:"Read Only"}),e.jsx("p",{className:"text-xs text-gray-600",children:"No further modifications allowed"})]})]})]}),!r&&!u&&e.jsxs("div",{className:"p-6 bg-green-50 border-b border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(I,{className:"w-6 h-6 text-green-600"}),e.jsx("h4",{className:"text-lg font-semibold text-green-900",children:"Approval Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/60 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Approved By"})]}),e.jsx("p",{className:"text-sm text-green-800 font-semibold",children:a.approved_by_name||a.approved_by||"System"}),e.jsx("p",{className:"text-xs text-gray-600",children:a.approved_by_email||a.approved_by||""})]}),e.jsxs("div",{className:"bg-white/60 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Approved At"})]}),e.jsx("p",{className:"text-sm text-green-800 font-semibold",children:a.approved_at?new Date(a.approved_at).toLocaleString():"N/A"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Approval timestamp"})]})]}),a.approval_reason&&e.jsxs("div",{className:"mt-4 bg-white/60 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Approval Notes"})]}),e.jsx("p",{className:"text-sm text-green-800",children:a.approval_reason})]})]}),a.tasks&&a.tasks.length>0&&e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-green-600"}),"Project Tasks (",a.tasks.length,")"]}),e.jsx("div",{className:"space-y-4",children:a.tasks.map((i,v)=>{var N,C;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:i.title}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${i.status==="Completed"?"bg-green-100 text-green-800":i.status==="IN_PROGRESS"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:i.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:i.total_duration?`${Math.round(i.total_duration/3600*100)/100}h`:"0h"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsxs("span",{children:[((N=i.assignees)==null?void 0:N.length)||0," assignee",((C=i.assignees)==null?void 0:C.length)!==1?"s":""]})]})]}),i.assignees&&i.assignees.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Assigned to:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.assignees.map((f,_)=>e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:[e.jsx(W,{className:"w-3 h-3"}),f.name]},_))})]}),i.checklists&&i.checklists.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Checklists:"}),e.jsx("div",{className:"space-y-1",children:i.checklists.map((f,_)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{children:f.title||"Untitled"}),f.due_date&&e.jsxs("span",{className:"text-gray-500",children:["(Due: ",new Date(f.due_date).toLocaleDateString(),")"]})]},_))})]})]})})},i.id||i.public_id||v)})})]}),a.attachments&&a.attachments.length>0&&e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),"Attachments (",a.attachments.length,")"]}),e.jsx("div",{className:"space-y-2",children:a.attachments.map((i,v)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:i.name||`Attachment ${v+1}`})]},v))})]}),e.jsx("div",{className:"px-6 py-3 bg-gray-50 text-xs text-gray-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Created: ",new Date(a.created_at).toLocaleString()]}),a.updated_at&&e.jsxs("span",{children:["Updated: ",new Date(a.updated_at).toLocaleString()]})]})})]})};function ls(){var oe;const a=ve(),r=T(s=>{var t;return(t=s.auth)==null?void 0:t.user}),b=T(Ve),j=T($e),l=T(We),[p,u]=c.useState([]),[w,i]=c.useState("table"),[v,N]=c.useState(!1),[C,f]=c.useState(null),[_,F]=c.useState(null),[H,Y]=c.useState(null),[L,M]=c.useState(""),[h,B]=c.useState({scope:"all",status:"all",department:"all"}),[K,E]=c.useState(!1),[R,o]=c.useState(""),[x,ae]=c.useState(!1),[X,P]=c.useState(""),[k,Ae]=c.useState(new Set),re=r==null?void 0:r.role,V=re==="Admin",D=re==="Manager",le={name:"",description:"",scope:"GLOBAL",triggerEvent:"TASK_REVIEW",active:!0,departmentId:"",projectId:""},[d,S]=c.useState(le),[es,ss]=c.useState(""),Z=T(s=>{var t;return(t=s.approval)==null?void 0:t.queue});c.useEffect(()=>{if(V)a(U("ADMIN")).catch(s=>{});else if(D&&r){const s=r.user_id||r.userId||r.numeric_id||r.id;s&&a(U(s)).catch(t=>{})}},[a,V,D,r]),c.useEffect(()=>{V&&Array.isArray(Z)&&u(Z)},[Z,V]),c.useEffect(()=>{D&&a(Ge()).catch(s=>{})},[a,D]),c.useEffect(()=>{if(D&&l){const s=l.id||l._id||l.public_id;k.has(s)&&a(ue(null))}},[D,l,k,a]);const z=()=>{N(!1),f(null),S(le)},ne=s=>{s&&(f(s),S({name:s.name||"",description:s.description||"",scope:(s.scope||"GLOBAL").toUpperCase(),triggerEvent:s.trigger_event||s.triggerEvent||"TASK_REVIEW",active:s.active!==!1,departmentId:(s.department_id||s.departmentId||"").toString(),projectId:(s.project_id||s.projectId||"").toString()}),N(!0))},Ee=s=>{s&&u(t=>t.filter(n=>n.id!==s.id))},Re=async s=>{if(s&&s.preventDefault&&s.preventDefault(),!d.name.trim())return;if(C){u(g=>g.map($=>$.id===C.id?{...$,name:d.name.trim(),description:d.description,scope:d.scope,trigger_event:d.triggerEvent,active:d.active,department_id:d.departmentId||null,project_id:d.projectId||null}:$)),z();return}const t=b.find(g=>String(g._id||g.id||g.public_id)===String(d.departmentId||"")),m=[l,...j||[]].filter(Boolean).find(g=>String(g._id||g.id||g.public_id)===String(d.projectId||"")),y={name:d.name.trim(),trigger_event:d.triggerEvent,scope:d.scope,active:d.active,department_id:d.departmentId||null,department_name:t?t.name||t.department_name:null,project_id:d.projectId||null,project_name:m?m.name||m.project_name:null,tenant_id:(r==null?void 0:r.tenant_id)||(r==null?void 0:r.tenantId)||(r==null?void 0:r.tenant)||(r==null?void 0:r.company_id)||null,created_by:(r==null?void 0:r._id)||(r==null?void 0:r.id)||(r==null?void 0:r.public_id)||(r==null?void 0:r.email)||null};u(g=>[...g,{id:Date.now(),...y,active:y.active!==!1,steps:[]}]),z()},ke=async()=>{if(!R.trim()){P("Please provide a reason for project closure");return}if(!l){P("No project selected");return}ae(!0),P("");try{const s={projectId:l.id||l._id,projectPublicId:l.public_id||l.id||l._id,reason:R.trim(),attachments:[],notify:!0},t=await a(Ye(s)).unwrap();if((t==null?void 0:t.success)===!1||t!=null&&t.error){let m=(t==null?void 0:t.error)||(t==null?void 0:t.message)||"Failed to request project closure";typeof m=="string"&&m.includes("All tasks must be COMPLETED")&&(m="Cannot close project: All tasks must be completed first. Please ensure all project tasks are marked as completed before requesting closure."),A.error(m),P(m);return}A.success((t==null?void 0:t.message)||"Project closure request submitted successfully");const n=l.id||l._id||l.public_id;Ae(m=>new Set([...m,n])),E(!1),o(""),P("")}catch(s){let t="Failed to request project closure";s!=null&&s.message&&(s.message.includes("All tasks must be COMPLETED")?t="Cannot close project: All tasks must be completed first. Please ensure all project tasks are marked as completed before requesting closure.":t=s.message),A.error(t),P(t)}finally{ae(!1)}},O=p.filter(s=>{if(!s)return!1;const t=(s.name||"").toString(),n=(s.description||"").toString(),m=t.toLowerCase().includes(L.toLowerCase())||n.toLowerCase().includes(L.toLowerCase()),y=h.scope==="all"||(s.scope||"").toString().toLowerCase()===h.scope.toLowerCase(),g=h.status==="all"||(h.status==="active"?s.active!==!1:s.active===!1),$=(s.department_id||s.departmentId||"").toString(),De=h.department==="all"||$===h.department;return m&&y&&g&&De}),q=(s,t)=>{B(n=>({...n,[s]:n[s]===t?"all":t}))},ce=()=>{B({scope:"all",status:"all",department:"all"}),M("")},ie=s=>{switch(s==null?void 0:s.toUpperCase()){case"PROJECT":return"bg-blue-100 text-blue-700 border-blue-200";case"DEPARTMENT":return"bg-purple-100 text-purple-700 border-purple-200";case"GLOBAL":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},de=s=>s!==!1?"bg-green-50 text-green-700 border-green-200":"bg-gray-50 text-gray-600 border-gray-200";return p.length,p.filter(s=>s.active!==!1).length,p.filter(s=>{var t;return((t=s.scope)==null?void 0:t.toUpperCase())==="PROJECT"}).length,p.filter(s=>{var t;return((t=s.scope)==null?void 0:t.toUpperCase())==="DEPARTMENT"}).length,p.filter(s=>{var t;return((t=s.scope)==null?void 0:t.toUpperCase())==="GLOBAL"||!s.scope}).length,V?e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx(he,{title:"Workflow Management",subtitle:"Design, automate, and monitor approval workflows across your organization",onRefresh:()=>{a(U("ADMIN")).catch(s=>{})}})}),p.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between items-start lg:items-center",children:[e.jsxs("div",{className:"relative w-full lg:w-96",children:[e.jsx(ee,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{value:L,onChange:s=>M(s.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Search workflows by name or description..."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl",children:[e.jsxs("button",{onClick:()=>i("table"),className:`px-4 py-2 rounded-lg font-medium text-sm transition-all ${w==="table"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Be,{className:"inline w-4 h-4 mr-2"}),"Table"]}),e.jsxs("button",{onClick:()=>i("cards"),className:`px-4 py-2 rounded-lg font-medium text-sm transition-all ${w==="cards"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ke,{className:"inline w-4 h-4 mr-2"}),"Cards"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>q("scope","project"),className:`px-3 py-1.5 rounded-lg text-sm font-medium border transition-all ${h.scope==="project"?"bg-blue-50 text-blue-700 border-blue-200":"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100"}`,children:"Project Scope"}),e.jsx("button",{onClick:()=>q("scope","department"),className:`px-3 py-1.5 rounded-lg text-sm font-medium border transition-all ${h.scope==="department"?"bg-purple-50 text-purple-700 border-purple-200":"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100"}`,children:"Department Scope"}),e.jsx("button",{onClick:()=>q("status","active"),className:`px-3 py-1.5 rounded-lg text-sm font-medium border transition-all ${h.status==="active"?"bg-green-50 text-green-700 border-green-200":"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100"}`,children:"Active Only"}),h.scope!=="all"||h.status!=="all"||h.department!=="all"?e.jsxs("button",{onClick:ce,className:"px-3 py-1.5 rounded-lg text-sm font-medium text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Clear Filters"]}):null]})]})]})}),e.jsxs("div",{className:"p-6",children:[w==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Workflow"}),e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Scope"}),e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Project / Department"}),e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Status"}),e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Last Updated"}),e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:O.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"py-12 text-center",children:[e.jsx(ee,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No workflows found. Try adjusting your filters."})]})}):O.map(s=>{var t,n;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-1",children:s.description||"No description"})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${ie(s.scope)}`,children:s.scope||"GLOBAL"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(je,{className:"w-4 h-4 text-gray-600"})}),e.jsx("span",{className:"text-sm text-gray-700",children:((t=s.scope)==null?void 0:t.toUpperCase())==="PROJECT"?s.project_name||"Project-specific":((n=s.scope)==null?void 0:n.toUpperCase())==="DEPARTMENT"?s.department_name||"Department-specific":"Global"})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${de(s.active)}`,children:s.active!==!1?"Active":"Inactive"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:s.created_at?new Date(s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"â€”"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F(s),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"View Details",children:e.jsx(be,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{onClick:()=>{Y(s),i("kanban")},className:"p-2 hover:bg-blue-50 rounded-lg transition-colors",title:"View Kanban",children:e.jsx(Ne,{className:"w-5 h-5 text-blue-600"})}),e.jsx("button",{onClick:()=>ne(s),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit",children:e.jsx(ze,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{onClick:()=>Ee(s),className:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Je,{className:"w-5 h-5 text-red-600"})})]})})]},s.id)})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.length===0?e.jsxs("div",{className:"col-span-3 py-12 text-center",children:[e.jsx(ee,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No workflows match your filters"}),e.jsx("button",{onClick:ce,className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Clear all filters"})]}):O.map(s=>{var t,n,m;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-500 text-sm mt-1 line-clamp-2",children:s.description||"No description provided"})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ie(s.scope)}`,children:s.scope||"GLOBAL"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(je,{className:"w-4 h-4 text-gray-600"})}),e.jsx("span",{className:"text-sm text-gray-700",children:((t=s.scope)==null?void 0:t.toUpperCase())==="PROJECT"?s.project_name||"Project-specific":((n=s.scope)==null?void 0:n.toUpperCase())==="DEPARTMENT"?s.department_name||"Department-specific":"Global"})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${de(s.active)}`,children:s.active!==!1?"Active":"Inactive"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["STEPS (",((m=s.steps)==null?void 0:m.length)||0,")"]}),e.jsx("span",{className:"text-xs text-gray-400",children:s.trigger_event||"Manual"})]}),e.jsxs("div",{className:"space-y-2",children:[(s.steps||[]).slice(0,3).map((y,g)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:g+1})}),e.jsx("span",{className:"text-sm text-gray-700",children:y.name})]},g)),(s.steps||[]).length>3&&e.jsx("div",{className:"text-center pt-2",children:e.jsxs("span",{className:"text-xs text-gray-400",children:["+",(s.steps||[]).length-3," more steps"]})})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>F(s),className:"text-sm text-gray-600 hover:text-gray-900 font-medium flex items-center gap-1",children:[e.jsx(be,{className:"w-4 h-4"}),"View Details"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{Y(s),i("kanban")},className:"px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-100 transition-colors flex items-center gap-1",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Kanban"]}),e.jsx("button",{onClick:()=>ne(s),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Edit"})]})]})]},s.id)})}),O.length>0&&e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-100",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:O.length})," of ",e.jsx("span",{className:"font-medium",children:p.length})," workflows"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50",children:"Previous"}),e.jsx("button",{className:"px-3 py-2 rounded-lg bg-blue-600 text-white",children:"1"}),e.jsx("button",{className:"px-3 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50",children:"2"}),e.jsx("button",{className:"px-3 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50",children:"Next"})]})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex justify-center items-center z-50",children:e.jsxs("form",{onSubmit:Re,className:"bg-white p-6 rounded-2xl shadow-xl w-full max-w-md space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:C?"Edit Workflow":"Create Workflow"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure scope, trigger, and ownership for this workflow"})]}),e.jsx("button",{onClick:z,type:"button",className:"text-gray-400 hover:text-gray-600",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Workflow Name *"}),e.jsx("input",{className:"w-full border border-gray-200 rounded-lg p-2.5 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.name,onChange:s=>S(t=>({...t,name:s.target.value})),placeholder:"e.g., HR Payroll Approval",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Scope *"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2.5 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.scope,onChange:s=>S(t=>({...t,scope:s.target.value})),children:[e.jsx("option",{value:"GLOBAL",children:"Global"}),e.jsx("option",{value:"DEPARTMENT",children:"Department"}),e.jsx("option",{value:"PROJECT",children:"Project"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Trigger Event *"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2.5 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.triggerEvent,onChange:s=>S(t=>({...t,triggerEvent:s.target.value})),children:[e.jsx("option",{value:"TASK_CREATED",children:"Task Created"}),e.jsx("option",{value:"TASK_REVIEW",children:"Task Review"}),e.jsx("option",{value:"TASK_COMPLETED",children:"Task Completed"})]})]})]}),(d.scope==="DEPARTMENT"||d.scope==="PROJECT")&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Department"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2.5 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.departmentId,onChange:s=>S(t=>({...t,departmentId:s.target.value})),children:[e.jsx("option",{value:"",children:"Select Department"}),b.map(s=>{const t=String(s._id||s.id||s.public_id),n=s.name||s.department_name||"Unnamed Department";return e.jsx("option",{value:t,children:n},t)})]})]}),d.scope==="PROJECT"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Project"}),e.jsxs("select",{className:"w-full border border-gray-200 rounded-lg p-2.5 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.projectId,onChange:s=>S(t=>({...t,projectId:s.target.value})),children:[e.jsx("option",{value:"",children:"Select Project"}),[l,...j||[]].filter(Boolean).map(s=>{const t=String(s._id||s.id||s.public_id),n=s.name||s.project_name||"Unnamed Project";return e.jsx("option",{value:t,children:n},t)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsx("input",{id:"wf-active",type:"checkbox",checked:d.active,onChange:s=>S(t=>({...t,active:s.target.checked})),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"wf-active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700",children:C?"Save Changes":"Create Workflow"})]})]})}),e.jsx("div",{className:"mt-8",children:e.jsx(qe,{})})]}):D?e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx(he,{title:"Project Management",subtitle:"Request project closures and manage workflow approvals",onRefresh:()=>{if(r){const s=r.user_id||r.userId||r.numeric_id||r.id;a(U(s)).catch(t=>{})}}})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Project Closure Requests"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Request closure for completed projects requiring admin approval"})]}),e.jsxs("button",{onClick:()=>{E(!0),P("")},disabled:x||!l,className:"bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 disabled:from-gray-400 disabled:to-gray-500 text-white px-6 py-3 rounded-xl font-medium flex items-center gap-2 shadow-lg hover:shadow-xl disabled:shadow-none transition-all duration-200",children:[x?e.jsx(Ue,{className:"w-5 h-5 animate-spin"}):e.jsx(se,{className:"w-5 h-5"}),"Request Project Closure"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project to Close *"}),e.jsxs("select",{value:(l==null?void 0:l.id)||(l==null?void 0:l._id)||"",onChange:s=>{const t=j.find(n=>(n.id||n._id)===s.target.value);t&&a(ue(t))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose a project..."}),j.filter(s=>{var y;const t=(y=s.status)==null?void 0:y.toUpperCase(),n=s.id||s._id||s.public_id,m=k.has(n);return(t==="ACTIVE"||t==="REVIEW"||t==="PENDING_FINAL_APPROVAL")&&!m}).map(s=>e.jsxs("option",{value:s.id||s._id,children:[s.name||s.title||`Project ${s.id||s._id}`,s.status&&`(${s.status})`]},s.id||s._id))]}),j.filter(s=>{var y;const t=(y=s.status)==null?void 0:y.toUpperCase(),n=s.id||s._id||s.public_id,m=k.has(n);return(t==="ACTIVE"||t==="REVIEW"||t==="PENDING_FINAL_APPROVAL")&&!m}).length===0&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No projects available for closure. Projects with pending closure requests are hidden. Please contact admin if you believe this is an error."})]}),l&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Selected Project:"}),e.jsx("span",{className:"text-sm text-blue-700",children:l.name||l.title})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${((oe=l.status)==null?void 0:oe.toUpperCase())==="ACTIVE"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.status||"Unknown Status"})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Closure requests will be submitted for the selected project."})]}),k.size>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(_e,{className:"w-5 h-5 text-amber-600"}),e.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Projects with Pending Closure Requests"})]}),e.jsx("div",{className:"space-y-2",children:Array.from(k).map(s=>{const t=j.find(n=>(n.id||n._id||n.public_id)===s);return e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-md p-3 border border-amber-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-amber-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:(t==null?void 0:t.name)||(t==null?void 0:t.title)||`Project ${s}`})]}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-amber-100 text-amber-800 rounded-full",children:"Pending Approval"})]},s)})}),e.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"These projects have closure requests pending admin approval and cannot be submitted again."})]}),k.size===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(se,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Project closure requests will appear here once submitted"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Task Approval Queue"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review pending task completion requests from your team"})]}),e.jsx("div",{className:"p-6",children:e.jsx(Xe,{})})]}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Request Project Closure"}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"space-y-4",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Project to Close:"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:l.name||l.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Closure *"}),e.jsx("textarea",{value:R,onChange:s=>{o(s.target.value),X&&P("")},placeholder:"Provide details about why this project should be closed...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:4,required:!0})]}),X&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-800",children:X})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ke,disabled:!R.trim()||x,className:"flex-1 px-4 py-2 bg-orange-600 hover:bg-orange-700 disabled:bg-orange-400 text-white rounded-lg font-medium transition-colors disabled:cursor-not-allowed",children:x?"Submitting...":"Submit Request"})]})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(fe,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"No project is currently selected."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Please select a project first to request its closure."}),e.jsx("button",{onClick:()=>E(!1),className:"mt-4 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Close"})]})})]})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(He,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to access workflow management."})]})})}export{ls as default};

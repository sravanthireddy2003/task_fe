import{b as L,s as A,r,a3 as _,i as k,j as e,an as M}from"./index-hc4IkIQj.js";const D=()=>{L(A);const[i,N]=r.useState([]),[d,c]=r.useState(!0),[m,x]=r.useState(null),[a,u]=r.useState(null),[l,v]=r.useState(""),[n,w]=r.useState("all"),o=r.useCallback(async()=>{c(!0);try{const s=await _("/api/manager/clients"),t=Array.isArray(s==null?void 0:s.data)?s.data:s;N(Array.isArray(t)?t:[]),x(null)}catch(s){const t=(s==null?void 0:s.message)||"Failed to load assigned clients";x(t),k.error(t)}finally{c(!1)}},[]);r.useEffect(()=>{o()},[o]);const g=r.useMemo(()=>(!d&&i.length>0?i:[]).filter(t=>{var p,b,y,j,f;const C=!l||((p=t.name)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))||((b=t.company)==null?void 0:b.toLowerCase().includes(l.toLowerCase()))||((y=t.email)==null?void 0:y.toLowerCase().includes(l.toLowerCase())),S=n==="all"||n==="active"&&((j=t.status)==null?void 0:j.toLowerCase())!=="inactive"||n==="inactive"&&((f=t.status)==null?void 0:f.toLowerCase())==="inactive";return C&&S}),[i,d,l,n]),h=r.useMemo(()=>((a==null?void 0:a.documents)??[]).map(s=>({...s,url:s.file_url})),[a]);return e.jsxs("div",{className:"w-full p-4 space-y-4",children:[e.jsx(M,{title:"Assigned Clients",subtitle:"You can only see clients assigned to you.",onRefresh:o,refreshing:d,children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search clients by name, company, email...",value:l,onChange:s=>v(s.target.value),className:"border rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("select",{value:n,onChange:s=>w(s.target.value),className:"border rounded-md px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),a?e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 shadow",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-600",children:"Client Detail"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.company||"—"})]}),e.jsx("button",{onClick:()=>u(null),className:"text-sm font-medium text-blue-600 hover:text-blue-800",children:"← Back to list"})]}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[{label:"Client Ref",value:a.ref||"—"},{label:"Manager",value:a.manager_name||"—"},{label:"Status",value:a.status||"Active"},{label:"Created",value:a.created_at?new Date(a.created_at).toLocaleString():"N/A"},{label:"Email",value:a.email||"—"},{label:"Phone",value:a.phone||"—"}].map(s=>e.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-500",children:s.label}),e.jsx("p",{className:"mt-1 text-base font-medium text-gray-900",children:s.value})]},s.label))}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500",children:"Documents & Uploads"}),h.length===0?e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"No documents uploaded yet."}):e.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:h.map(s=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"rounded-xl border border-gray-100 bg-gray-50 p-3 text-sm font-medium text-blue-600 transition hover:border-blue-200",children:[e.jsx("p",{className:"truncate font-semibold",children:s.file_name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.file_type})]},s.id))})]})]}):d?e.jsx("div",{className:"rounded-lg bg-white p-6 text-center text-gray-500 border border-dashed border-gray-200",children:"Fetching assigned clients..."}):g.length===0?e.jsx("div",{className:"rounded-lg bg-white p-6 text-center text-gray-500 border border-dashed border-gray-200",children:m||"No assigned clients found."}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:[e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Company"}),e.jsx("th",{className:"px-4 py-2",children:"Status"}),e.jsx("th",{className:"px-4 py-2",children:"Email"}),e.jsx("th",{className:"px-4 py-2",children:"Phone"})]})}),e.jsx("tbody",{children:g.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>u(s),children:[e.jsx("td",{className:"px-4 py-2 text-gray-900",children:s.name}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:s.company||"-"}),e.jsx("td",{className:"px-4 py-2 text-xs",children:e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 font-medium ${s.status==="Inactive"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:s.status||(s.isDeleted?"Inactive":"Active")})}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:s.email||"-"}),e.jsx("td",{className:"px-4 py-2 text-gray-700",children:s.phone||"-"})]},s.id||s.public_id||s._id))})]})})]})};export{D as default};

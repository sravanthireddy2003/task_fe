import{u as y,b as n,c as j,d as N,s as S,a as v,j as s,B as C,by as q,i as h,bz as D}from"./index-hc4IkIQj.js";import{u as B}from"./index.esm-BAuHutGw.js";import{P as k}from"./PasswordStrength-DbYVaYpd.js";import{T as l}from"./Textbox-CzrBNsnO.js";import{g as A}from"./index-pGm2xic7.js";const _=()=>{var u,g,P;const c=y(),o=n(j),w=n(N),p=n(S),i=v(),{register:t,handleSubmit:b,watch:x,formState:{errors:d}}=B(),m=x("newPassword",""),f=async e=>{try{console.debug("ChangePassword onSubmit payload:",e);const r={oldPassword:e.oldPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword,old_password:e.oldPassword,new_password:e.newPassword};console.debug("Dispatching changePassword with payload:",r);const a=await c(q(r)).unwrap();console.debug("changePassword result:",a),h.success((a==null?void 0:a.message)||"Password changed successfully. Please log in again."),c(D()),i("/log-in")}catch(r){console.error("changePassword error:",r);const a=(r==null?void 0:r.message)||r||"Failed to change password";h.error(a)}};return s.jsx("div",{className:"w-full min-h-screen flex items-center justify-center bg-gray-50 p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-lg shadow-lg",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Change Password"}),s.jsxs("form",{onSubmit:b(f),className:"flex flex-col gap-4",children:[s.jsx(l,{label:"Old Password",name:"oldPassword",type:"password",register:t("oldPassword",{required:"Old password required"}),error:(u=d.oldPassword)==null?void 0:u.message}),s.jsx(l,{label:"New Password",name:"newPassword",type:"password",register:t("newPassword",{required:"New password required"}),error:(g=d.newPassword)==null?void 0:g.message}),s.jsx(k,{password:m}),s.jsx(l,{label:"Confirm New Password",name:"confirmPassword",type:"password",register:t("confirmPassword",{required:"Please confirm new password",validate:e=>e===m||"Passwords do not match"}),error:(P=d.confirmPassword)==null?void 0:P.message}),s.jsx(C,{type:"submit",label:o==="loading"?"Updating...":"Change Password",className:"bg-blue-600 text-white rounded hover:bg-blue-700 transition py-2",disabled:o==="loading"}),o==="failed"&&w&&s.jsx("p",{className:"text-red-500 text-sm mt-2",children:w}),s.jsx("button",{type:"button",onClick:()=>{const e=A(p);i(e,{replace:!0})},className:"mt-4 text-blue-600 hover:underline text-center w-full",children:"Back to Dashboard"})]})]})})};export{_ as default};

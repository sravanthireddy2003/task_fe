import{r as n,j as e,aJ as w,aG as B,aH as E,a as J,u as K,g as Z,b as F,aK as q,aL as z,aM as W,X as Y,ao as ee,ac as M,aN as _,a9 as $,aA as se,aO as H,L as te,aP as X,Z as ae,F as re,aQ as le,aE as ne,aR as ie,aS as oe,e as ce,aT as de}from"./index-DOgJOjDG.js";import xe from"./ClientForm-z1wFdrRY.js";import{C as me}from"./Card-HTkRXD5q.js";import{V as he}from"./ViewToggle-Cn4ab9dT.js";import"./index.esm-BUzRow5i.js";import"./ModalWrapper-fJKczzlE.js";const ge=({clients:C,onEdit:u,onRowClick:v,onDelete:p})=>{const[l,R]=n.useState(""),[k,S]=n.useState("asc"),[i,L]=n.useState(""),[a,o]=n.useState(1),[y,x]=n.useState(5),f=t=>{S(l===t&&k==="asc"?"desc":"asc"),R(t)},c=C.filter(t=>{var r,d,h;return((r=t.name)==null?void 0:r.toLowerCase().includes(i.toLowerCase()))||((d=t.company)==null?void 0:d.toLowerCase().includes(i.toLowerCase()))||((h=t.manager_name||t.managerName||t.manager)==null?void 0:h.toString().toLowerCase().includes(i.toLowerCase()))}).sort((t,r)=>{if(l)if(k==="asc"){const d=(t[l]??t[l]??"").toString().toLowerCase(),h=(r[l]??r[l]??"").toString().toLowerCase();return d>h?1:-1}else{const d=(t[l]??t[l]??"").toString().toLowerCase(),h=(r[l]??r[l]??"").toString().toLowerCase();return d<h?1:-1}return 0}),N=c.length,m=Math.ceil(N/y),A=c.slice((a-1)*y,a*y),j=t=>{o(t)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name, company, or manager...",value:i,onChange:t=>L(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),e.jsxs("div",{className:"text-xs font-medium text-gray-600 whitespace-nowrap",children:[N," result",N!==1?"s":""]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>f("ref"),className:"flex items-center gap-2 text-xs font-semibold text-gray-700 hover:text-gray-900 transition-colors",children:["Ref",e.jsx(w,{className:"tm-icon"})]})}),e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>f("company"),className:"flex items-center gap-2 text-xs font-semibold text-gray-700 hover:text-gray-900 transition-colors",children:["Company",e.jsx(w,{className:"tm-icon"})]})}),e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>f("name"),className:"flex items-center gap-2 text-xs font-semibold text-gray-700 hover:text-gray-900 transition-colors",children:["Name",e.jsx(w,{className:"tm-icon"})]})}),e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>f("manager_name"),className:"flex items-center gap-2 text-xs font-semibold text-gray-700 hover:text-gray-900 transition-colors",children:["Manager",e.jsx(w,{className:"tm-icon"})]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:A.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-sm text-gray-500",children:"No clients found"})}):A.map(t=>e.jsxs("tr",{onClick:()=>v(t),className:"hover:bg-blue-50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.ref||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.company||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-100 flex items-center justify-center text-xs font-semibold text-blue-600",children:(t.name||"C").charAt(0).toUpperCase()}),t.name||"-"]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.manager_name||t.managerName||t.manager||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 truncate max-w-xs",children:t.email||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.phone||"-"}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),u(t)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors icon-center",title:"Edit",children:e.jsx(B,{className:"tm-icon"})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),p(t.id)},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors icon-center",title:"Delete",children:e.jsx(E,{className:"tm-icon"})})]})})]},t.id))})]})}),m>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>j(1),disabled:a===1,className:"px-2 py-1 text-xs font-medium border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"First"}),e.jsx("button",{onClick:()=>j(a-1),disabled:a===1,className:"px-2 py-1 text-xs font-medium border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Prev"}),e.jsxs("span",{className:"px-3 py-1 text-xs text-gray-700 font-medium",children:["Page ",a," of ",m]}),e.jsx("button",{onClick:()=>j(a+1),disabled:a===m,className:"px-2 py-1 text-xs font-medium border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"}),e.jsx("button",{onClick:()=>j(m),disabled:a===m,className:"px-2 py-1 text-xs font-medium border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Last"})]})]})},Ne=()=>{var I;const C=J(),u=K(),v=Z(),p=F(q),l=F(z),R=F(W),k=F(Y),[S,i]=n.useState(!1),[L,a]=n.useState(null),[o,y]=n.useState(""),[x,f]=n.useState("all"),[c,N]=n.useState("all"),[m,A]=n.useState("list"),[j,t]=n.useState(!1),r=async()=>{t(!0);try{await Promise.all([u(X()),u(ae({role:"Manager"}))])}finally{setTimeout(()=>t(!1),500)}};n.useEffect(()=>{r()},[u]);const d=async s=>{if(window.confirm("Are you sure you want to delete this client?"))try{await u(de(s)).unwrap()}catch(g){console.error("Failed to delete client:",g)}},h=k.filter(s=>(s.role||"").toLowerCase().includes("manager")),D=p.filter(s=>{var V,O,Q;const g=!o||((V=s.name)==null?void 0:V.toLowerCase().includes(o.toLowerCase()))||((O=s.company)==null?void 0:O.toLowerCase().includes(o.toLowerCase()))||((Q=s.email)==null?void 0:Q.toLowerCase().includes(o.toLowerCase())),b=x==="all"||x==="active"&&!s.isDeleted||x==="deleted"&&s.isDeleted,P=c==="all"||(s.manager_public_id||s.managerId)===c;return g&&b&&P}),T={total:p.length,active:p.filter(s=>!s.isDeleted).length,deleted:p.filter(s=>s.isDeleted).length},G=({client:s})=>{var g,b,P;return e.jsxs(me,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-blue-700 font-bold text-base",children:((b=(g=s.name)==null?void 0:g.charAt(0))==null?void 0:b.toUpperCase())||"C"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1 truncate",children:[e.jsx(_,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.company||"No company"})]})]})]}),e.jsxs("span",{className:re("px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1",s.isDeleted?"bg-red-50 text-red-700":"bg-green-50 text-green-700"),children:[s.isDeleted?e.jsx(le,{className:"tm-icon"}):e.jsx($,{className:"tm-icon"}),e.jsx("span",{className:"hidden sm:inline",children:s.isDeleted?"Deleted":"Active"})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(ne,{className:"tm-icon text-gray-400"}),e.jsx("span",{className:"truncate",children:s.email||"No email"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(ie,{className:"tm-icon text-gray-400"}),e.jsx("span",{children:s.phone||"No phone"})]})]}),e.jsx("div",{className:"border-t border-gray-100 pt-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("p",{className:"text-gray-500",children:"Manager"}),e.jsxs("p",{className:"font-medium text-gray-900 flex items-center gap-1",children:[e.jsx(oe,{className:"tm-icon text-gray-400"}),((P=s.managerName)==null?void 0:P.split(" ")[0])||"Unassigned"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>C(`/client-dashboard/${s.id}`),className:"p-1.5 hover:bg-gray-100 rounded text-gray-500 hover:text-blue-600 transition-colors icon-center",title:"View",children:e.jsx(ce,{className:"tm-icon"})}),e.jsx("button",{onClick:()=>{a(s),i(!0)},className:"p-1.5 hover:bg-gray-100 rounded text-gray-500 hover:text-blue-600 transition-colors icon-center",title:"Edit",children:e.jsx(B,{className:"tm-icon"})}),e.jsx("button",{onClick:()=>d(s.id),className:"p-1.5 hover:bg-red-50 rounded text-gray-500 hover:text-red-600 transition-colors icon-center",title:"Delete",children:e.jsx(E,{className:"tm-icon"})})]})]})})]})};if(l==="loading"&&!j)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-40"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-56"})]}),e.jsx("div",{className:"h-9 bg-gray-200 rounded-lg w-28"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-12 bg-gray-200 rounded-lg"},s))})]})});if(l==="failed")return e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg border border-red-200 p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(E,{className:"tm-icon"})}),e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-2",children:"Failed to load clients"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:R||"An error occurred"}),e.jsxs("button",{onClick:r,className:"bg-gray-800 hover:bg-black text-white px-4 py-2 rounded-lg text-sm font-medium inline-flex items-center gap-1.5",children:[e.jsx(w,{className:"tm-icon"}),"Try Again"]})]})})});const U=(I=v==null?void 0:v.state)==null?void 0:I.message;return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsx(ee,{title:"Clients",subtitle:"Manage your client portfolio",onRefresh:r,refreshing:j,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{mode:m,onChange:A}),e.jsxs("button",{onClick:()=>{a(null),i(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium inline-flex items-center gap-1.5",children:[e.jsx(M,{className:"tm-icon"}),"Add Client"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 p-5 flex flex-col gap-3 min-h-[120px]",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsx("div",{className:"p-2.5 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(_,{className:"w-5 h-5 text-gray-700 flex-shrink-0"})})}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1 justify-end",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900 leading-tight",children:T.total}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Total Clients"})]})]}),e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-emerald-200 bg-emerald-50/60 hover:border-emerald-300 shadow-sm hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 p-5 flex flex-col gap-3 min-h-[120px]",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsx("div",{className:"p-2.5 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx($,{className:"w-5 h-5 text-gray-700 flex-shrink-0"})})}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1 justify-end",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900 leading-tight",children:T.active}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Active"})]})]}),e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-red-200 bg-red-50/60 hover:border-red-300 shadow-sm hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 p-5 flex flex-col gap-3 min-h-[120px]",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsx("div",{className:"p-2.5 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(E,{className:"w-5 h-5 text-gray-700 flex-shrink-0"})})}),e.jsxs("div",{className:"flex flex-col gap-1 flex-1 justify-end",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900 leading-tight",children:T.deleted}),e.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Deleted"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search by name, company, or email...",value:o,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:x,onChange:s=>f(s.target.value),className:"w-full pl-3 pr-9 py-2.5 border border-gray-300 rounded-lg appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-medium",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"deleted",children:"Deleted"})]}),e.jsx(H,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none w-4 h-4"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:c,onChange:s=>N(s.target.value),className:"w-full pl-3 pr-9 py-2.5 border border-gray-300 rounded-lg appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-medium",children:[e.jsx("option",{value:"all",children:"All Managers"}),h.map((s,g)=>{const b=s.public_id||s._id||s.id||s.publicId||s.email||`mgr-${g}`;return e.jsx("option",{value:b,children:s.name},b)})]}),e.jsx(H,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none w-4 h-4"})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium text-gray-900",children:D.length})," of"," ",e.jsx("span",{className:"font-medium text-gray-900",children:p.length})," clients"]}),(o||x!=="all"||c!=="all")&&e.jsx("button",{onClick:()=>{y(""),f("all"),N("all")},className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Clear filters"})]}),U&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(CheckCircle2,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Success"}),e.jsx("p",{className:"text-xs text-green-700",children:U})]})]})}),D.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(_,{className:"w-6 h-6 text-gray-400"})}),e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-1",children:o||x!=="all"||c!=="all"?"No clients found":"No clients yet"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-sm mx-auto",children:o||x!=="all"||c!=="all"?"Try adjusting your search or filters":"Add your first client to get started"}),e.jsx(te,{to:"/add-client",children:e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium inline-flex items-center gap-1.5",children:[e.jsx(M,{className:"tm-icon"}),"Add First Client"]})})]}):m==="grid"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:[D.map(s=>e.jsx(G,{client:s},s.id)),e.jsxs("div",{onClick:()=>{a(null),i(!0)},className:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-300 hover:bg-blue-50 transition-all duration-300 cursor-pointer flex flex-col items-center justify-center min-h-[280px]",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-dashed border-gray-400 flex items-center justify-center mb-3 bg-white",children:e.jsx(M,{className:"w-6 h-6 text-gray-500"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Add New Client"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Click to create"})]})]})}):e.jsxs("div",{className:"tm-list-container",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsx(ge,{clients:D,onEdit:s=>{a(s),i(!0)},onRowClick:s=>C(`/client-dashboard/${s.id}`),onDelete:d})}),e.jsx("div",{className:"border-t border-gray-200 p-3",children:e.jsxs("button",{onClick:()=>{a(null),i(!0)},className:"inline-flex items-center gap-1.5 text-blue-600 hover:text-blue-700 text-sm font-medium",children:[e.jsx(M,{className:"tm-icon"}),"Add New Client"]})})]}),(S||L)&&e.jsx(xe,{open:S,setOpen:i,client:L,onSuccess:()=>{a(null),i(!1),u(X())},isModal:!0})]})})};export{Ne as default};

import{r as a,u as ie,ch as ke,ci as ce,cj as Re,ck as Ie,cl as Ee,cm as Te,cn as $e,b as I,co as De,cp as Ae,cq as Le,cr as Pe,cs as Oe,ct as Ue,cu as O,cv as He,cw as Be,cx as Q,aM as G,aF as W,cy as q,cz as V,az as Z,cA as Y,cB as K,cC as L,af as X,ca as ee,i as E,cD as ze,j as e,cE as Fe,cF as Je,G as de,ao as Qe}from"./index-7TXHU69M.js";import{a as Ge}from"./index-pGm2xic7.js";const We=(o,j,v={})=>{const t=a.useRef(null),x=ie(),i=a.useRef(o),p=a.useRef(null),{onMessageReceived:f}=v;a.useEffect(()=>{i.current=o},[o]),a.useEffect(()=>{if(!j)return;const m=$e;return t.current||(t.current=ke(m,{auth:{token:j},reconnection:!0,reconnectionDelay:500,reconnectionDelayMax:5e3,reconnectionAttempts:10,transports:["websocket","polling"]}),t.current.on("connect",()=>{}),t.current.on("disconnect",()=>{}),t.current.on("connect_error",()=>{})),()=>{}},[j]),a.useEffect(()=>{!o||!t.current||(p.current&&p.current!==o&&t.current.emit("leave_project_chat",p.current),t.current.emit("join_project_chat",o),p.current=o)},[o]),a.useEffect(()=>{if(!t.current)return;const m=n=>{n&&(n.id||n._id)&&(x(ce(n)),f&&f())},_=n=>{n&&Array.isArray(n)&&x(Re(n))},N=n=>{n!=null&&n.userId&&x(Ie({user_id:n.userId,user_name:n.userName||"Unknown",user_role:n.userRole||"user",is_online:!0,last_seen:new Date().toISOString()}))},M=n=>{n!=null&&n.userId&&x(Ee(n.userId))},C=n=>{console.log("[Chat] ðŸ—‘ï¸ Message deleted:",n==null?void 0:n.messageId),n!=null&&n.messageId&&x(Te(n.messageId))},k=n=>{console.error("[Chat] âŒ Socket.IO error:",n)},D=n=>{console.log("[Chat] ðŸ“¦ Received batch of messages:",n==null?void 0:n.length),n&&Array.isArray(n)&&(n.forEach(R=>{R&&(R.id||R._id)&&x(ce(R))}),f&&(console.log("[Chat] ðŸ”„ Triggering onMessageReceived callback for batch"),f()))};return console.log("[Chat] ðŸ”Œ Registering Socket.IO event listeners..."),t.current.on("chat_message",m),t.current.on("new_message",m),t.current.on("message_received",m),t.current.on("new_messages_batch",D),t.current.on("online_participants",_),t.current.on("user_joined",N),t.current.on("user_left",M),t.current.on("message_deleted",C),t.current.on("error",k),console.log("[Chat] âœ… All event listeners registered"),()=>{console.log("[Chat] ðŸ§¹ Cleaning up event listeners"),t.current&&(t.current.off("chat_message",m),t.current.off("new_message",m),t.current.off("message_received",m),t.current.off("new_messages_batch",D),t.current.off("online_participants",_),t.current.off("user_joined",N),t.current.off("user_left",M),t.current.off("message_deleted",C),t.current.off("error",k))}},[x]);const b=a.useCallback(m=>{t.current&&i.current&&(console.log("[Chat] Sending message:",m),t.current.emit("send_message",{projectId:i.current,message:m,timestamp:new Date().toISOString()}))},[]),h=a.useCallback(()=>{t.current&&i.current&&(console.log("[Chat] User started typing"),t.current.emit("typing_start",{projectId:i.current,timestamp:new Date().toISOString()}))},[]),T=a.useCallback(()=>{t.current&&i.current&&(console.log("[Chat] User stopped typing"),t.current.emit("typing_stop",{projectId:i.current,timestamp:new Date().toISOString()}))},[]),$=a.useCallback(m=>{t.current&&i.current&&(console.log("[Chat] Executing command:",m),t.current.emit("chatbot_command",{projectId:i.current,command:m,timestamp:new Date().toISOString()}))},[]),y=a.useCallback(()=>{var m;return((m=t.current)==null?void 0:m.connected)||!1},[]),S=a.useCallback(()=>{t.current&&!t.current.connected&&(console.log("[Chat] Attempting manual reconnect..."),t.current.connect())},[]);return{sendMessage:b,sendTypingStart:h,sendTypingStop:T,sendChatbotCommand:$,socket:t.current,isConnected:y,reconnect:S}},es=({projectId:o,projectName:j,authToken:v,currentUserId:t,currentUserName:x})=>{var oe;const i=ie(),p=I(De),f=I(Ae),b=I(Le),h=I(Pe),T=I(Oe),$=I(Ue),[y,S]=a.useState(""),[m,_]=a.useState(!1),[N,M]=a.useState(!1),[C,k]=a.useState(!1),[D,n]=a.useState(!1),[R,P]=a.useState(!1),[se,U]=a.useState(""),[H,ue]=a.useState(0),B=a.useRef(null),z=a.useRef(null),[xe,ge]=a.useState(!1),te=a.useRef(null);a.useRef(p.length);const re=a.useRef(null),{sendTypingStart:he,sendTypingStop:ne,sendChatbotCommand:F,isConnected:J,reconnect:fe}=We(o,v,{onMessageReceived:()=>{i(O({projectId:o,limit:50,offset:0}))}});a.useEffect(()=>{if(o){console.log("ðŸ“¨ Loading messages for projectId:",o),i(O({projectId:o,limit:50,offset:0})).then(r=>{var l,c;console.log("âœ… Messages loaded:",((c=(l=r.payload)==null?void 0:l.data)==null?void 0:c.length)||0)}).catch(r=>{console.error("âŒ Error loading messages:",r)}),i(He(o)),i(Be(o));const s=setInterval(()=>{console.log("ðŸ”„ Refetching messages..."),i(O({projectId:o,limit:50,offset:0}))},5e3);return()=>clearInterval(s)}},[o,i]),a.useEffect(()=>{console.log("chat icons:",{Paperclip:ee,Send:X,MessageCircle:L,Zap:K,BarChart3:Y,Users:Z,HelpCircle:V,ChevronRight:q,Trash2:W,ChevronDown:G,RefreshCw:Q})},[]),a.useEffect(()=>{$&&(E.error($),i(ze()))},[$,i]),a.useEffect(()=>{const s=z.current;if(!s)return;const{scrollTop:r,scrollHeight:l,clientHeight:c}=s;if(r+c>=l-100){const u=setTimeout(()=>{var w;(w=B.current)==null||w.scrollIntoView({behavior:"smooth"})},100);return()=>clearTimeout(u)}},[p]),a.useEffect(()=>{const s=z.current;if(!s)return;const r=()=>{const{scrollTop:l,scrollHeight:c,clientHeight:d}=s,u=l+d>=c-100;ge(!u)};return s.addEventListener("scroll",r),()=>s.removeEventListener("scroll",r)},[]);const be=s=>{const r=s.target.value;S(r);const l=s.target.selectionStart,c=r.lastIndexOf("@"),d=r.indexOf(" ",c);if(c!==-1&&(d===-1||d>l)){const u=r.substring(c+1,l).trim();U(u),ue(c),P(!0)}else P(!1),U("");D||(n(!0),he()),clearTimeout(te.current),te.current=setTimeout(()=>{n(!1),ne()},3e3)},pe=s=>{const r=y.substring(0,H),l=y.substring(y.indexOf(" ",H)===-1?y.length:y.indexOf(" ",H)),c=`${r}@${s} ${l}`.replace(/\s+/g," ").trim();S(c),P(!1),U(""),setTimeout(()=>{var d;return(d=re.current)==null?void 0:d.focus()},0)},ae=()=>{const s=[{name:"everyone",type:"special",icon:"ðŸ‘¥"},...f.map(r=>({name:r.user_name,type:"user",icon:"ðŸ‘¤",role:r.user_role}))];return se?s.filter(r=>r.name.toLowerCase().includes(se.toLowerCase())):s.slice(0,8)},ye=async s=>{if(s.preventDefault(),!y.trim())return;const r=y;S(""),P(!1);try{J()||(fe(),E.warning("Connection issue, retrying..."));const l=await i(Je({projectId:o,message:r})).unwrap();E.success("Message sent"),n(!1),ne()}catch(l){console.error("âŒ Error sending message:",l),E.error("Failed to send message"),S(r)}},je=async s=>{if(window.confirm("Delete this message?"))try{await i(Fe({projectId:o,messageId:s})).unwrap(),E.success("Message deleted")}catch{E.error("Failed to delete message")}},ve=s=>{switch(s.toLowerCase().trim()){case"/help":k(!C);break;case"/tasks":F(s);break;case"/status":_(!m);break;case"/members":case"/online":M(!N);break;case"/project":F(s);break;default:F(s)}},le=s=>{const r=new Date(s);return`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}`},we=()=>{var s;(s=B.current)==null||s.scrollIntoView({behavior:"smooth"})},Ne=(s,r=!1)=>{if(!s||typeof s!="string")return s||"";const l=/@(\w+)/g,c=[];let d=0,u;for(;(u=l.exec(s))!==null;){u.index>d&&c.push(e.jsx("span",{children:s.substring(d,u.index)},`text-${d}`));const w=u[1],g=w.toLowerCase()==="everyone";r?c.push(e.jsxs("span",{className:`font-semibold ${g?"bg-red-400 text-white px-1 rounded":"bg-blue-400 text-white px-1 rounded"}`,children:["@",w]},`mention-${u.index}`)):c.push(e.jsxs("span",{className:`font-semibold ${g?"text-red-600 bg-red-200 px-1 rounded":"text-blue-600 bg-blue-200 px-1 rounded"}`,children:["@",w]},`mention-${u.index}`)),d=u.index+u[0].length}return d<s.length&&c.push(e.jsx("span",{children:s.substring(d)},`text-${d}`)),c.length>0?c:s},Ce=s=>{var w;if(s.message_type==="bot")return!1;const r=s.sender_id??s.senderId??s.user_id??s.userId??s.sender??s.from??(s.user&&(s.user.id||s.user._id));let l=null;try{const g=JSON.parse(localStorage.getItem("userInfo")||"{}");l=g.public_id||g._id||g.id||g.userId,console.log("âœ… Got currentIdRaw from localStorage.userInfo:",l)}catch{console.log("âš ï¸ Could not parse localStorage.userInfo")}if(l||(l=t,console.log("âœ… Got currentIdRaw from prop:",l)),!l&&typeof v=="string")try{const g=v.split(".");if(g.length>=2){const Se=g[1].replace(/-/g,"+").replace(/_/g,"/"),_e=decodeURIComponent(atob(Se).split("").map(Me=>"%"+("00"+Me.charCodeAt(0).toString(16)).slice(-2)).join("")),A=JSON.parse(_e);l=A.id||A._id||A.sub||A.userId||A.public_id,console.log("âœ… Got currentIdRaw from JWT:",l)}}catch{console.log("âš ï¸ Could not decode JWT")}const c=g=>g||g===0?String(g).trim().toLowerCase():null,d=c(r),u=c(l);return console.log("ðŸ“¨ Message sender check:",{senderIdRaw:r,currentIdRaw:l,senderId:d,curId:u,messageType:s.message_type,messageText:(w=s.message)==null?void 0:w.substring(0,30),isMatch:d&&u&&d===u}),d&&u&&d===u?(console.log("âœ… MATCH FOUND - Message is from current user"),!0):!1};return e.jsxs("div",{className:"flex flex-col h-full bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 font-bold text-lg",children:"ðŸ’¬"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:j||"Project Chat"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${J()?"bg-success-500 animate-pulse":"bg-warning-500"}`}),e.jsx("p",{className:"text-xs font-medium text-gray-600",children:J()?"Connected":"Reconnecting..."})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{console.log("ðŸ”„ Manually refreshing messages..."),i(O({projectId:o,limit:50,offset:0}))},className:"p-2.5 hover:bg-gray-50 text-gray-600 hover:text-gray-800 rounded-lg transition-all duration-200",title:"Refresh messages",children:Q&&e.jsx(Q,{className:"tm-icon"})}),e.jsx("button",{className:"p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Messages",children:L&&e.jsx(L,{className:"tm-icon"})}),e.jsx("button",{className:"p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Commands",children:K&&e.jsx(K,{className:"tm-icon"})}),e.jsx("button",{onClick:()=>_(!m),className:`p-2.5 rounded-lg transition-all duration-200 ${m?"bg-blue-50 text-blue-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,title:"Stats",children:Y&&e.jsx(Y,{className:"tm-icon"})}),e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>M(!N),className:`p-2.5 rounded-lg transition-all duration-200 relative ${N?"bg-blue-50 text-blue-600":"hover:bg-gray-50 text-gray-600 hover:text-gray-800"}`,title:"Online Members",children:[Z&&e.jsx(Z,{className:"tm-icon"}),f.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:f.length})]})}),e.jsx("button",{onClick:()=>k(!C),className:`p-2 hover:bg-gray-100 rounded-lg transition-colors ${C?"bg-blue-50 text-blue-600":"text-gray-600"}`,title:"Help",children:V&&e.jsx(V,{className:"tm-icon"})})]})]}),m&&b&&e.jsxs("div",{className:"flex-shrink-0 bg-gray-50 border-b border-gray-200 px-6 py-5 grid grid-cols-2 md:grid-cols-4 gap-4 relative",children:[e.jsx("button",{onClick:()=>_(!1),className:"absolute top-2 right-2 p-1 hover:bg-gray-200 rounded",title:"Close",children:"âœ•"}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.total_messages||0}),e.jsx("p",{className:"text-xs font-medium text-gray-600 mt-2",children:"Messages"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.unique_senders||0}),e.jsx("p",{className:"text-xs font-medium text-gray-600 mt-2",children:"Participants"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.online_participants||0}),e.jsx("p",{className:"text-xs font-medium text-gray-600 mt-2",children:"Online"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:b.last_message_time?le(b.last_message_time):"â€”"}),e.jsx("p",{className:"text-xs font-medium text-gray-600 mt-2",children:"Last Active"})]})]}),N&&e.jsxs("div",{className:"flex-shrink-0 bg-gray-50 border-b border-gray-200 px-6 py-5 max-h-64 overflow-y-auto relative",children:[e.jsx("button",{onClick:()=>M(!1),className:"absolute top-2 right-2 p-1 hover:bg-gray-200 rounded",title:"Close",children:"âœ•"}),e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-lg",children:"ðŸ‘¥"}),"Team Members (",f.length,")"]}),e.jsx("div",{className:"space-y-2",children:f.length===0?e.jsx("p",{className:"text-sm text-gray-500 py-4 text-center",children:"No members yet"}):f.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"w-9 h-9 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:(s.user_name||"U").charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:s.user_name}),e.jsx("p",{className:"text-xs text-gray-600 capitalize",children:s.user_role||"Member"})]}),e.jsx("div",{className:"w-2.5 h-2.5 bg-success-500 rounded-full flex-shrink-0 animate-pulse"})]},s.user_id))})]}),C&&e.jsxs("div",{className:"flex-shrink-0 bg-gray-50 border-b border-gray-200 px-6 py-5 max-h-64 overflow-y-auto relative",children:[e.jsx("button",{onClick:()=>k(!1),className:"absolute top-2 right-2 p-1 hover:bg-gray-200 rounded",title:"Close",children:"âœ•"}),e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’¡"}),"Quick Commands"]}),e.jsx("div",{className:"space-y-2",children:[{cmd:"/help",desc:"Show available commands"},{cmd:"/tasks",desc:"List your assigned tasks"},{cmd:"/status",desc:"Show chat statistics"},{cmd:"/members",desc:"Show project members"},{cmd:"/online",desc:"Show online members"},{cmd:"/project",desc:"Show project information"}].map(s=>e.jsxs("button",{onClick:()=>ve(s.cmd),className:"w-full text-left p-3 bg-white rounded-lg hover:bg-gray-50 transition-all border border-gray-200 hover:border-gray-300 hover:shadow-sm flex items-center justify-between group",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:s.cmd}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:s.desc})]}),q&&e.jsx(q,{className:"tm-icon text-gray-400 group-hover:text-gray-600 transition-colors"})]},s.cmd))})]}),e.jsxs("div",{ref:z,className:"relative flex-1 overflow-y-auto bg-gray-50",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 py-3 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:j}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{children:[f.length," online"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-gray-500",children:[(b==null?void 0:b.total_messages)||0," messages"]})})]})}),e.jsxs("div",{className:"px-4 py-6 max-w-5xl mx-auto space-y-4",children:[h&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-gray-200 border-t-gray-600 rounded-full mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading messages..."})]})}),!h&&p.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-400",children:[L&&e.jsx(L,{className:"tm-icon-hero mb-3 opacity-50"}),e.jsx("p",{className:"text-gray-500",children:"No messages yet. Start the conversation!"})]}),p.filter(s=>s&&(s.message||s.message==="")).map(s=>{var l,c,d;const r=Ce(s);return e.jsxs("div",{className:`flex gap-2 ${r?"justify-end":"justify-start"}`,children:[!r&&e.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center text-white text-xs font-bold shadow-sm ${s.message_type==="bot"?"bg-gray-600":"bg-gray-500"}`,children:s.message_type==="bot"?"ðŸ¤–":((c=(l=s.sender_name)==null?void 0:l.charAt(0))==null?void 0:c.toUpperCase())||"?"}),e.jsx("div",{className:`flex flex-col gap-1 ${r?"items-end":"items-start"}`,children:e.jsxs("div",{className:`max-w-sm ${r?"lg:max-w-md":""}`,children:[!r&&s.sender_name&&e.jsxs("p",{className:`text-xs font-semibold mb-1 px-2 ${s.message_type==="bot","text-gray-600"}`,children:[s.message_type==="bot"?"ðŸ¤– ":"",s.sender_name]}),e.jsx("div",{className:`rounded-2xl px-4 py-3 shadow-sm transition-all ${r?"bg-blue-600 text-white rounded-br-none":s.message_type==="bot"?"bg-gray-100 text-gray-900 rounded-bl-none border border-gray-200":"bg-white text-gray-900 rounded-bl-none border border-gray-200"} break-words whitespace-pre-wrap`,children:e.jsx("p",{className:"text-sm leading-relaxed font-medium",children:Ne(s.message||"",r)})}),e.jsxs("div",{className:`flex items-center gap-2 mt-2 px-2 text-xs font-medium ${r?"justify-end text-gray-600":"justify-start text-gray-500"}`,children:[e.jsx("span",{children:le(s.created_at||s.timestamp)}),r&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-medium",children:"YOU"}),r&&e.jsx("button",{onClick:()=>je(s.id||s._id),className:"text-gray-400 hover:text-red-500 transition-colors ml-1 hover:scale-110 icon-center",title:"Delete message",children:W&&e.jsx(W,{className:"tm-icon"})})]})]})}),r&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-white text-xs font-bold",children:((d=x==null?void 0:x.charAt(0))==null?void 0:d.toUpperCase())||"U"})]},s.id||s._id)}),D&&e.jsxs("div",{className:"flex justify-end gap-2 animate-fadeIn",children:[e.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[e.jsx("div",{className:"bg-blue-600 text-white rounded-2xl rounded-br-none px-4 py-3 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full animate-bounce"}),e.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})}),e.jsx("span",{className:"text-xs text-gray-500 px-2",children:"Typing..."})]}),e.jsx("div",{className:"flex-shrink-0 w-9 h-9 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs font-bold shadow-sm",children:((oe=x==null?void 0:x.charAt(0))==null?void 0:oe.toUpperCase())||"U"})]}),xe&&e.jsx("button",{onClick:we,className:"absolute bottom-4 right-4 bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-full shadow-lg transition-all duration-200 z-10",title:"Scroll to bottom",children:G&&e.jsx(G,{className:"tm-icon"})}),e.jsx("div",{ref:B})]})]}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white relative",children:[R&&ae().length>0&&e.jsx("div",{className:"absolute bottom-full left-4 right-4 mb-3 bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-48 overflow-y-auto",children:e.jsx("div",{className:"py-2",children:ae().map((s,r)=>e.jsxs("button",{type:"button",onClick:()=>pe(s.name),className:"w-full text-left px-4 py-2.5 hover:bg-gray-50 transition-colors flex items-center gap-3 group",children:[e.jsx("span",{className:"text-lg",children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800 truncate",children:["@",s.name,s.type==="special"&&e.jsx("span",{className:"text-xs text-gray-600 ml-1",children:"(Notify all)"})]}),s.role&&e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s.role})]})]},r))})}),e.jsx("form",{onSubmit:ye,className:"px-5 py-4 max-w-5xl mx-auto",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"p-2.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200",title:"Attach file",children:ee&&e.jsx(ee,{className:"tm-icon"})}),e.jsx("input",{ref:re,type:"text",value:y,onChange:be,placeholder:"Type @ to mention someone...",className:"flex-1 border border-gray-300 rounded-full px-5 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-transparent text-sm bg-white transition-all placeholder-gray-400",disabled:T}),e.jsx("button",{type:"submit",disabled:!y.trim()||T,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all min-w-[44px] min-h-[44px] flex items-center justify-center shadow-sm hover:shadow-md disabled:shadow-none",title:"Send message",children:T?e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}):X&&e.jsx(X,{className:"tm-icon"})})]})})]})]})},{MessageCircle:qe,ChevronDown:Ve,Search:Ze,Settings:Ye}=de,ss=({title:o="Team Chat",projects:j,selectedProjectId:v,onSelectProject:t,onRefresh:x=()=>{},user:i,children:p})=>{const[f,b]=a.useState("");return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-white border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center",children:e.jsx(qe,{className:"w-4 h-4 text-white"})}),e.jsx("div",{children:e.jsx("h1",{className:"font-semibold text-gray-900",children:o})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative hidden sm:block",children:[e.jsx(Ze,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search messages...",value:f,onChange:h=>b(h.target.value),className:"pl-9 pr-3 py-1.5 bg-gray-100 rounded-lg border border-gray-300 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm w-48"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:v||"",onChange:h=>t(h.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 py-1.5 pr-8 text-sm text-gray-700 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 cursor-pointer min-w-[140px]",children:j.map(h=>e.jsx("option",{value:h._id||h.id,children:h.name||h.title},h._id||h.id))}),e.jsx(Ve,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{onClick:x,loading:!1,className:"p-0"}),e.jsx("button",{className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ye,{className:"w-5 h-5"})}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center text-white text-sm font-semibold",children:Ge((i==null?void 0:i.name)||"User")})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:p})]})},{MessageCircle:me}=de,ts=({message:o="Loading conversations..."})=>e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-3 border-gray-200 border-t-blue-600 rounded-full animate-spin mb-3"}),e.jsx(me,{className:"w-5 h-5 text-blue-600 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-3",children:o})]})}),rs=({title:o="No projects found",description:j="Create a project to start team collaboration",helperText:v,actionLabel:t,onAction:x})=>e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-sm p-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-xl bg-blue-50 flex items-center justify-center border border-blue-100",children:e.jsx(me,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:o}),e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:j}),v&&e.jsx("p",{className:"text-gray-400 text-xs",children:v}),t&&x&&e.jsx("button",{type:"button",onClick:x,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:t})]})});export{ts as C,rs as a,ss as b,es as c};
